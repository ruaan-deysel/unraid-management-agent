# CodeQL configuration for unraid-management-agent
# See https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/customizing-code-scanning

name: "Custom CodeQL Configuration"

# Paths to ignore from analysis
paths-ignore:
  - "vendor/**"
  - "**/testdata/**"
  - "**/test/**"
  - "**/tests/**"
  - "**/*_test.go"
  - "daemon/lib/testutil/**"
  - "daemon/docs/**"

# Query configuration
queries:
  # Use default queries plus security-extended
  - uses: security-extended
  - uses: security-and-quality

# Query filters - suppress specific alerts that are false positives
# for this codebase (system file access, known-safe paths)
query-filters:
  # Exclude file inclusion alerts for system paths (/sys, /proc, etc.)
  # These are intentional system file accesses, not user-input vulnerabilities
  - exclude:
      id: go/path-injection
      # The codebase accesses /sys/class/*, /proc/*, cgroup paths which are
      # system directories, not user-controlled paths

  # Exclude integer overflow for statfs Bsize which is always positive
  - exclude:
      id: go/integer-overflow
      # syscall.Statfs_t.Bsize is always positive on Linux systems
